<Ui>
    <Frame name="$parentOptions" parent="ModelEditor">
        <Anchors>
            <Anchor point="LEFT" relativeTo="$parentSplitterThumbTexture" relativePoint="RIGHT">
                <Offset>
                    <AbsDimension x="0"/>
                </Offset>
            </Anchor>
            <Anchor point="RIGHT">
                <Offset>
                    <AbsDimension x="-12"/>
                </Offset>
            </Anchor>
            <Anchor point="TOP">
                <Offset>
                    <AbsDimension y="28"/>
                </Offset>
            </Anchor>
            <Anchor point="BOTTOM">
                <Offset>
                    <AbsDimension y="-12"/>
                </Offset>
            </Anchor>
        </Anchors>
        <Backdrop edgeFile="Interface/Editor/Templates/Border2PX.png">
            <BackgroundColor a="0.25" r="1" g="1" b="1"/>
        </Backdrop>
        <Layers>
            <Layer>
                <Texture name="$parentPickSeparator" file="Interface/Editor/EscMenu/EscMenu_Separator.png">
                    <Size>
                        <AbsDimension y="16"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOP" relativeTo="$parentPickModel" relativePoint="BOTTOM"/>
                        <Anchor point="LEFT"/>
                        <Anchor point="RIGHT"/>
                    </Anchors>
                </Texture>
                <Texture name="$parentSaveSeparator" file="Interface/Editor/EscMenu/EscMenu_Separator.png">
                    <Size>
                        <AbsDimension y="16"/>
                    </Size>
                    <Anchors>
                        <Anchor point="BOTTOM" relativeTo="$parentNameEditBox" relativePoint="TOP">
                            <Offset>
                                <AbsDimension y="2"/>
                            </Offset>
                        </Anchor>
                        <Anchor point="LEFT"/>
                        <Anchor point="RIGHT"/>
                    </Anchors>
                </Texture>
                <FontString name="$parentSubModelCaption" font="Fonts/Vera.ttf" fontHeight="10" justifyH="RIGHT">
                    <Size>
                        <AbsDimension y="18"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOP" relativeTo="$parentShowAll" relativePoint="BOTTOM">
                            <Offset>
                                <AbsDimension y="3"/>
                            </Offset>
                        </Anchor>
                        <Anchor point="LEFT"/>
                        <Anchor point="RIGHT" relativePoint="CENTER"/>
                    </Anchors>
                </FontString>
                <FontString name="$parentSubEntityCaption" font="Fonts/Vera.ttf" fontHeight="10" justifyH="RIGHT">
                    <Size>
                        <AbsDimension y="18"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOP" relativeTo="$parentSubModelCaption" relativePoint="BOTTOM">
                            <Offset>
                                <AbsDimension y="1"/>
                            </Offset>
                        </Anchor>
                        <Anchor point="LEFT"/>
                        <Anchor point="RIGHT" relativePoint="CENTER"/>
                    </Anchors>
                </FontString>
                <FontString name="$parentSetColorCaption" font="Fonts/Vera.ttf" fontHeight="10" justifyH="LEFT">
                    <Size>
                        <AbsDimension y="18"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOP" relativeTo="$parentIsolateSelected" relativePoint="BOTTOM">
                            <Offset>
                                <AbsDimension y="3"/>
                            </Offset>
                        </Anchor>
                        <Anchor point="LEFT" relativeTo="$parentColorTextureSwitch" relativePoint="RIGHT">
                            <Offset>
                                <AbsDimension x="3"/>
                            </Offset>
                        </Anchor>
                    </Anchors>
                </FontString>
                <FontString name="$parentSetTextureCaption" font="Fonts/Vera.ttf" fontHeight="10" justifyH="LEFT">
                    <Size>
                        <AbsDimension y="18"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOP" relativeTo="$parentSetColorCaption" relativePoint="BOTTOM">
                            <Offset>
                                <AbsDimension y="1"/>
                            </Offset>
                        </Anchor>
                        <Anchor point="LEFT" relativeTo="$parentColorTextureSwitch" relativePoint="RIGHT">
                            <Offset>
                                <AbsDimension x="3"/>
                            </Offset>
                        </Anchor>
                    </Anchors>
                </FontString>
            </Layer>
        </Layers>
        <Frames>
            <Button name="$parentPickFile" inherits="ButtonTemplate_Button">
                <Anchors>
                    <Anchor point="TOP">
                        <Offset>
                            <AbsDimension y="5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT">
                        <Offset>
                            <AbsDimension x="5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT">
                        <Offset>
                            <AbsDimension x="-5"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetText(AddOns.ModelEditor:GetLocalizedString("PickModelFile"));
                    </OnLoad>
                    <OnClick>
                        FileSelector:Show();
                        FileSelector:Raise();
                        FileSelector:SelectFolder("Models");
                        FileSelector:SetOnOkFunc(function()
                            ModelEditor.Model.File:SetText(FileSelector:GetSelectedFile());
                            ModelEditor.Model:SetModel(FileSelector:GetSelectedFile());
                            ModelEditor.Options.Add:Enable();
                            ModelEditor.Options.PickModel:SelectElement(nil);
                            ModelEditor:OnModelSelected();
                        end);
                    </OnClick>
                </Scripts>
            </Button>
            <Frame name="$parentPickModel" inherits="FrameTemplate_ScrollableDropDown">
                <Anchors>
                    <Anchor point="TOP" relativeTo="$parentPickFile" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="3"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT">
                        <Offset>
                            <AbsDimension x="5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT">
                        <Offset>
                            <AbsDimension x="-5"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetDropDownDefaultText(AddOns.ModelEditor:GetLocalizedString("PickModel"));
                        this:SetDropDownMaxHeight(80);
                        this:RegisterEvent("ZONE_LOADED");
                        this:RegisterEvent("MODEL_CREATED");
                        
                        this.onSelect = function (value)
                            if (value == nil) then return end;
                            local model = Editor:GetModelFile(value);
                            local material = Editor:GetModelMaterial(value);
                            ModelEditor.Model.File:SetText(model);
                            ModelEditor.Model:SetModel(model);
                            ModelEditor.Model:SetMaterial(material);
                            ModelEditor.Options.NameEditBox:SetText(value);
                            ModelEditor.Options.Add:Enable();
                            ModelEditor.Options.Save:Enable();
                            ModelEditor:OnModelSelected();
                        end;
                    </OnLoad>
                    <OnEvent>
                        this:GetBase():OnEvent();
                        
                        if (event == "ADDON_LOADED") then
                            if (Editor:IsZoneLoaded()) then
                                local models = {Editor:GetZoneModelList()};
                                
                                for k, v in pairs(models) do
                                    this:AddDropDownElement(v, v);
                                end
                            end
                        elseif (event == "ZONE_LOADED" or event == "MODEL_CREATED") then
                            this:ClearDropDownElements();
                            local models = {Editor:GetZoneModelList()};
                            
                            for k, v in pairs(models) do
                                this:AddDropDownElement(v, v);
                            end
                        end
                    </OnEvent>
                </Scripts>
            </Frame>
            <Button name="$parentShowAll" inherits="ButtonTemplate_Button">
                <Anchors>
                    <Anchor point="TOP" relativeTo="$parentPickSeparator" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="-2"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT">
                        <Offset>
                            <AbsDimension x="5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT" relativePoint="CENTER">
                        <Offset>
                            <AbsDimension x="-1"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetText(AddOns.ModelEditor:GetLocalizedString("ShowAll"));
                    </OnLoad>
                    <OnClick>
                        ModelEditor.Model:ShowModel();
                    </OnClick>
                </Scripts>
            </Button>
            <Button name="$parentHideAll" inherits="ButtonTemplate_Button">
                <Anchors>
                    <Anchor point="TOP" relativeTo="$parentPickSeparator" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="-2"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT" relativePoint="CENTER">
                        <Offset>
                            <AbsDimension x="0"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT">
                        <Offset>
                            <AbsDimension x="-5"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetText(AddOns.ModelEditor:GetLocalizedString("HideAll"));
                    </OnLoad>
                    <OnClick>
                        ModelEditor.Model:HideModel();
                    </OnClick>
                </Scripts>
            </Button>
            <Frame name="$parentPickSubModel" inherits="FrameTemplate_ScrollableDropDown">
                <Size>
                    <AbsDimension x="50"/>
                </Size>
                <Anchors>
                    <Anchor point="TOP" relativeTo="$parentShowAll" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="3"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT" relativePoint="CENTER">
                        <Offset>
                            <AbsDimension x="3"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetDropDownDefaultText(AddOns.ModelEditor:GetLocalizedString("PickSubModel"));
                        this:SetDropDownMaxHeight(80);
                        
                        this.onSelect = function (value)
                            ModelEditor.subModel = value;
                            ModelEditor:OnSubModelSelected();
                        end;
                    </OnLoad>
                </Scripts>
            </Frame>
            <Frame name="$parentPickSubEntity" inherits="FrameTemplate_ScrollableDropDown">
                <Size>
                    <AbsDimension x="50"/>
                </Size>
                <Anchors>
                    <Anchor point="TOP" relativeTo="$parentPickSubModel" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="1"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT" relativePoint="CENTER">
                        <Offset>
                            <AbsDimension x="3"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetDropDownDefaultText(AddOns.ModelEditor:GetLocalizedString("PickSubEntity"));
                        this:SetDropDownMaxHeight(80);
                        
                        this.onSelect = function (value)
                            ModelEditor.subEntity = value;
                        end;
                    </OnLoad>
                </Scripts>
            </Frame>
            <Button name="$parentIsolateSelected" inherits="ButtonTemplate_Button">
                <Anchors>
                    <Anchor point="TOP" relativeTo="$parentPickSubEntity" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="3"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT">
                        <Offset>
                            <AbsDimension x="5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT" relativePoint="LEFT">
                        <Offset>
                            <RelDimension x="0.33"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetText(AddOns.ModelEditor:GetLocalizedString("Isolate"));
                    </OnLoad>
                    <OnClick>
                        ModelEditor.Model:HideModel();
                        if (ModelEditor.subEntity ~= nil) then
                            ModelEditor.Model:ShowSubEntity(ModelEditor.subModel, ModelEditor.subEntity);
                        elseif (ModelEditor.subModel ~= nil) then
                            ModelEditor.Model:ShowSubMesh(ModelEditor.subModel);
                        end
                    </OnClick>
                </Scripts>
            </Button>
            <Button name="$parentShowSelected" inherits="ButtonTemplate_Button">
                <Anchors>
                    <Anchor point="TOP" relativeTo="$parentPickSubEntity" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="3"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT" relativePoint="LEFT">
                        <Offset>
                            <RelDimension x="0.333"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT" relativePoint="RIGHT">
                        <Offset>
                            <RelDimension x="-0.333"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetText(AddOns.ModelEditor:GetLocalizedString("Show"));
                    </OnLoad>
                    <OnClick>
                        if (ModelEditor.subEntity ~= nil) then
                            ModelEditor.Model:ShowSubEntity(ModelEditor.subModel, ModelEditor.subEntity);
                        elseif (ModelEditor.subModel ~= nil) then
                            ModelEditor.Model:ShowSubMesh(ModelEditor.subModel);
                        end
                    </OnClick>
                </Scripts>
            </Button>
            <Button name="$parentHideSelected" inherits="ButtonTemplate_Button">
                <Anchors>
                    <Anchor point="TOP" relativeTo="$parentPickSubEntity" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="3"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT" relativePoint="RIGHT">
                        <Offset>
                            <RelDimension x="-0.33"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT">
                        <Offset>
                            <AbsDimension x="-5"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetText(AddOns.ModelEditor:GetLocalizedString("Hide"));
                    </OnLoad>
                    <OnClick>
                        if (ModelEditor.subEntity ~= nil) then
                            ModelEditor.Model:HideSubEntity(ModelEditor.subModel, ModelEditor.subEntity);
                        elseif (ModelEditor.subModel ~= nil) then
                            ModelEditor.Model:HideSubMesh(ModelEditor.subModel);
                        end
                    </OnClick>
                </Scripts>
            </Button>
            <Frame name="$parentColorTextureSwitch">
                <Size>
                    <AbsDimension x="18" y="36"/>
                </Size>
                <Anchors>
                    <Anchor point="TOPLEFT" relativeTo="$parentIsolateSelected" relativePoint="BOTTOMLEFT">
                        <Offset>
                            <AbsDimension y="3"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Frames>
                    <CheckButton name="$parentColor" inherits="CheckButtonTemplate_SwitchButton">
                        <Anchors>
                            <Anchor point="TOP">
                                <Offset>
                                    <AbsDimension y="1"/>
                                </Offset>
                            </Anchor>
                        </Anchors>
                        <Scripts>
                            <OnClick>
                                if (not ModelEditor.selectColor) then
                                    this:GetParent().Texture:SetChecked(false);
                                    ModelEditor.selectColor = true;
                                    ModelEditor.Options.ColorPicker:Enable();
                                    
                                    ModelEditor.Options.TextureEditBox:ClearFocus();
                                    ModelEditor.Options.TextureEditBox:EnableMouse(false);
                                    ModelEditor.Options.ValidateTextureButton:Disable();
                                    ModelEditor.Options.PickTextureButton:Disable();
                                else
                                    this:GetParent().Color:SetChecked(true);
                                end
                            </OnClick>
                        </Scripts>
                    </CheckButton>
                    <CheckButton name="$parentTexture" inherits="CheckButtonTemplate_SwitchButton">
                        <Anchors>
                            <Anchor point="BOTTOM"/>
                        </Anchors>
                        <Scripts>
                            <OnClick>
                                if (ModelEditor.selectColor) then
                                    this:GetParent().Color:SetChecked(false);
                                    ModelEditor.selectColor = false;
                                    ModelEditor.Options.TextureEditBox:EnableMouse(true);
                                    ModelEditor.Options.ValidateTextureButton:Enable();
                                    ModelEditor.Options.PickTextureButton:Enable();
                                    
                                    ModelEditor.Options.ColorPicker:Disable();
                                else
                                    this:GetParent().Texture:SetChecked(true);
                                end
                            </OnClick>
                        </Scripts>
                    </CheckButton>
                </Frames>
            </Frame>
            <Button name="$parentColorPicker" inherits="ButtonTemplate_ColorSwatch">
                <Anchors>
                    <Anchor point="LEFT" relativeTo="$parentSetColorCaption" relativePoint="RIGHT">
                        <Offset>
                            <AbsDimension x="5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="TOP" relativeTo="$parentIsolateSelected" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="4"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this.onColorChange = function (color)
                            if (ModelEditor.subEntity ~= nil) then
                                ModelEditor.Model:SetSubEntityTexture(ModelEditor.subModel, ModelEditor.subEntity, color:Unpack());
                            elseif (ModelEditor.subModel ~= nil) then
                                ModelEditor.Model:SetSubMeshTexture(ModelEditor.subModel, color:Unpack());
                            else
                                ModelEditor.Model:SetModelTexture(color:Unpack());
                            end
                        end;
                    </OnLoad>
                </Scripts>
            </Button>
            <EditBox name="$parentTextureEditBox" inherits="EditBoxTemplate_EditBox">
                <Anchors>
                    <Anchor point="LEFT" relativeTo="$parentSetTextureCaption" relativePoint="RIGHT">
                        <Offset>
                            <AbsDimension x="5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT" relativeTo="$parentValidateTextureButton" relativePoint="LEFT">
                        <Offset>
                            <AbsDimension x="-5"/>
                        </Offset>
                    </Anchor>
                </Anchors>
            </EditBox>
            <Button name="$parentValidateTextureButton" inherits="ButtonTemplate_Button">
                <Anchors>
                    <Anchor point="TOP" relativeTo="$parentColorPicker" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="2"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT" relativeTo="$parentPickTextureButton" relativePoint="LEFT">
                        <Offset>
                            <AbsDimension x="-2"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetText(AddOns.ModelEditor:GetLocalizedString("ValidateTexture"));
                    </OnLoad>
                    <OnClick>
                        ModelEditor.texture = this:GetParent().TextureEditBox:GetText();
                        if (ModelEditor.texture ~= "") then
                            if (ModelEditor.subEntity ~= nil) then
                                ModelEditor.Model:SetSubEntityTexture(ModelEditor.subModel, ModelEditor.subEntity, ModelEditor.texture, ModelEditor.alphaReject);
                            elseif (ModelEditor.subModel ~= nil) then
                                ModelEditor.Model:SetSubMeshTexture(ModelEditor.subModel, ModelEditor.texture, ModelEditor.alphaReject);
                            else
                                ModelEditor.Model:SetModelTexture(ModelEditor.texture, ModelEditor.alphaReject);
                            end
                        end
                    </OnClick>
                </Scripts>
            </Button>
            <Button name="$parentPickTextureButton" inherits="ButtonTemplate_Button">
                <Anchors>
                    <Anchor point="TOP" relativeTo="$parentColorPicker" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="2"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT">
                        <Offset>
                            <AbsDimension x="-5"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetText("...");
                    </OnLoad>
                    <OnClick>
                        FileSelector:Show();
                        FileSelector:Raise();
                        FileSelector:SelectFolder("Textures");
                        FileSelector:SetOnOkFunc(function()
                            ModelEditor.texture = FileSelector:GetSelectedFile();
                            ModelEditor.Options.TextureEditBox:SetText(ModelEditor.texture);
                            if (ModelEditor.texture ~= "") then
                                ModelEditor.Options.TextureEditBox:SetText(ModelEditor.texture);
                                if (ModelEditor.subEntity ~= nil) then
                                    ModelEditor.Model:SetSubEntityTexture(ModelEditor.subModel, ModelEditor.subEntity, ModelEditor.texture, ModelEditor.alphaReject);
                                elseif (ModelEditor.subModel ~= nil) then
                                    ModelEditor.Model:SetSubMeshTexture(ModelEditor.subModel, ModelEditor.texture, ModelEditor.alphaReject);
                                else
                                    ModelEditor.Model:SetModelTexture(ModelEditor.texture, ModelEditor.alphaReject);
                                end
                            end
                        end);
                    </OnClick>
                </Scripts>
            </Button>
            <CheckButton name="$parentAlphaReject">
                <Size>
                    <AbsDimension y="18"/>
                </Size>
                <Anchors>
                    <Anchor point="LEFT">
                        <Offset>
                            <AbsDimension x="5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT">
                        <Offset>
                            <AbsDimension x="-5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="TOP" relativeTo="$parentTextureEditBox" relativePoint="BOTTOM">
                        <Offset>
                            <AbsDimension y="3"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <NormalText font="Fonts/Vera.ttf" fontHeight="10" justifyH="LEFT" setAllPoints="false">
                    <Anchors>
                        <Anchor point="TOPLEFT">
                            <Offset>
                                <AbsDimension x="16" y="-3"/>
                            </Offset>
                        </Anchor>
                        <Anchor point="BOTTOMRIGHT"/>
                    </Anchors>
                    <Color r="1" g="1" b="1"/>
                </NormalText>
                <DisabledText font="Fonts/Vera.ttf" fontHeight="10" justifyH="LEFT" setAllPoints="false">
                    <Anchors>
                        <Anchor point="TOPLEFT">
                            <Offset>
                                <AbsDimension x="16" y="-3"/>
                            </Offset>
                        </Anchor>
                        <Anchor point="BOTTOMRIGHT"/>
                    </Anchors>
                    <Color r="0.5" g="0.5" b="0.5"/>
                </DisabledText>
                <NormalTexture file="Interface/Editor/Templates/CheckButtonBackground.png" setAllPoints="false">
                    <Size>
                        <AbsDimension x="8" y="8"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOPLEFT">
                            <Offset>
                                <AbsDimension x="4" y="3"/>
                            </Offset>
                        </Anchor>
                    </Anchors>
                </NormalTexture>
                <DisabledTexture file="Interface/Editor/Templates/CheckButtonDisabled.png" setAllPoints="false">
                    <Size>
                        <AbsDimension x="8" y="8"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOPLEFT">
                            <Offset>
                                <AbsDimension x="4" y="3"/>
                            </Offset>
                        </Anchor>
                    </Anchors>
                </DisabledTexture>
                <CheckedTexture file="Interface/Editor/Templates/CheckButtonChecked.png" setAllPoints="false">
                    <Size>
                        <AbsDimension x="8" y="8"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOPLEFT">
                            <Offset>
                                <AbsDimension x="4" y="3"/>
                            </Offset>
                        </Anchor>
                    </Anchors>
                </CheckedTexture>
                <HighlightTexture file="Interface/Editor/Templates/CheckButtonHighlight.png" setAllPoints="false">
                    <Size>
                        <AbsDimension x="16" y="16"/>
                    </Size>
                    <Anchors>
                        <Anchor point="TOPLEFT">
                            <Offset>
                                <AbsDimension y="-1"/>
                            </Offset>
                        </Anchor>
                    </Anchors>
                </HighlightTexture>
                <Scripts>
                    <OnLoad>
                        this:SetText(AddOns.ModelEditor:GetLocalizedString("AlphaReject"));
                    
                        this:RegisterEvent("ADDON_LOADED");
                        AddOns.Editor:RegisterTextColorFunction(this, function (self, color)
                            self:GetNormalFontObject():SetTextColor(color:Unpack());
                        end);
                        AddOns.Editor:RegisterSecondaryTextColorFunction(this, function (self, color)
                            self:GetDisabledFontObject():SetTextColor(color:Unpack());
                        end);
                    </OnLoad>
                    <OnEvent>
                        if (event == "ADDON_LOADED") then
                            AddOns.Editor:CallColorFunctions(this);
                        end
                    </OnEvent>
                    <OnClick>
                        ModelEditor.alphaReject = this:IsChecked();
                        if (not ModelEditor.selectColor and ModelEditor.texture ~= "") then
                            if (ModelEditor.subEntity ~= nil) then
                                ModelEditor.Model:SetSubEntityTexture(ModelEditor.subModel, ModelEditor.subEntity, ModelEditor.texture, ModelEditor.alphaReject);
                            elseif (ModelEditor.subModel ~= nil) then
                                ModelEditor.Model:SetSubMeshTexture(ModelEditor.subModel, ModelEditor.texture, ModelEditor.alphaReject);
                            else
                                ModelEditor.Model:SetModelTexture(ModelEditor.texture, ModelEditor.alphaReject);
                            end
                        end
                    </OnClick>
                </Scripts>
            </CheckButton>
            <EditBox name="$parentNameEditBox" inherits="EditBoxTemplate_EditBox">
                <Anchors>
                    <Anchor point="LEFT">
                        <Offset>
                            <AbsDimension x="5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT">
                        <Offset>
                            <AbsDimension x="-5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="BOTTOM" relativeTo="$parentSave" relativePoint="TOP">
                        <Offset>
                            <AbsDimension y="-3"/>
                        </Offset>
                    </Anchor>
                </Anchors>
            </EditBox>
            <Button name="$parentAdd" inherits="ButtonTemplate_Button">
                <Anchors>
                    <Anchor point="BOTTOM">
                        <Offset>
                            <AbsDimension y="-5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT">
                        <Offset>
                            <AbsDimension x="5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT" relativePoint="LEFT">
                        <Offset>
                            <RelDimension x="0.33"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetText(AddOns.ModelEditor:GetLocalizedString("Add"));
                    </OnLoad>
                    <OnClick>
                        ModelEditor.modelName = ModelEditor.Options.NameEditBox:GetText();
                        if (ModelEditor.modelName ~= "") then
                            if (not Editor:IsModelLoaded(ModelEditor.modelName)) then
                                Editor:RegisterNewModel(ModelEditor.modelName, ModelEditor.Model.File:GetText());
                                Editor:SetModelMaterial(ModelEditor.modelName, ModelEditor.Model:GetMaterial());
                                AddOns.Editor:NotifyDataChanged();
                            else
                                ModelEditor:Error(AddOns.ModelEditor:GetLocalizedString("ModelAlreadyExists"), 300, 110);
                            end
                        else
                            ModelEditor:Error(AddOns.ModelEditor:GetLocalizedString("ModelNoName"), 300, 100);
                        end
                    </OnClick>
                </Scripts>
            </Button>
            <Button name="$parentSave" inherits="ButtonTemplate_Button">
                <Anchors>
                    <Anchor point="BOTTOM">
                        <Offset>
                            <AbsDimension y="-5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT">
                        <Offset>
                            <RelDimension x="0.333"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT">
                        <Offset>
                            <RelDimension x="-0.333"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetText(AddOns.ModelEditor:GetLocalizedString("Save"));
                    </OnLoad>
                    <OnClick>
                        ModelEditor.modelName = ModelEditor.Options.NameEditBox:GetText();
                        if (ModelEditor.modelName ~= "") then
                            if (not Editor:IsModelLoaded(ModelEditor.modelName)) then
                                Editor:RegisterNewModel(ModelEditor.modelName, ModelEditor.Model.File:GetText());
                            else
                                Editor:EditModel(ModelEditor.modelName, ModelEditor.Model.File:GetText());
                            end
                            
                            Editor:SetModelMaterial(ModelEditor.modelName, ModelEditor.Model:GetMaterial());
                            AddOns.Editor:NotifyDataChanged();
                        else
                            ModelEditor:Error(AddOns.ModelEditor:GetLocalizedString("ModelNoName"), 300, 100);
                        end
                    </OnClick>
                </Scripts>
            </Button>
            <Button name="$parentCancel" inherits="ButtonTemplate_Button">
                <Anchors>
                    <Anchor point="BOTTOM">
                        <Offset>
                            <AbsDimension y="-5"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="LEFT" relativePoint="RIGHT">
                        <Offset>
                            <RelDimension x="-0.33"/>
                        </Offset>
                    </Anchor>
                    <Anchor point="RIGHT">
                        <Offset>
                            <AbsDimension x="-5"/>
                        </Offset>
                    </Anchor>
                </Anchors>
                <Scripts>
                    <OnLoad>
                        this:GetBase():OnLoad();
                        this:SetText(AddOns.ModelEditor:GetLocalizedString("Cancel"));
                    </OnLoad>
                    <OnClick>
                        ModelEditor:Hide();
                    </OnClick>
                </Scripts>
            </Button>
        </Frames>
    </Frame>
</Ui>
